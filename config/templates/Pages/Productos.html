{% extends 'Pages/Base.html' %}

{% load static %}

{% block css %}
{% endblock %}

<link rel="stylesheet" href="{% static 'config/css/style.css' %}">
{% block contenido %}

<a href="{% url 'crear_producto' %}" class="btn-crear">Agregar Nuevo Producto</a>

<!-- ðŸ”Ž FORMULARIO DE BUSQUEDA + CATEGORÃAS -->
<form method="GET" class="d-flex mb-3" style="gap:10px;">

    <!-- SELECT DE CATEGORÃAS -->
    <select name="categoria" class="form-select" style="max-width: 250px;">
        <option value="">Todas las categorÃ­as</option>

        {% for cat in categorias %}
            <option value="{{ cat.id }}"
                {% if categoria_seleccionada == cat.id|stringformat:"s" %}
                    selected
                {% endif %}
            >
                {{ cat.nombre }}
            </option>
        {% endfor %}
    </select>

    <!-- BUSCADOR -->
    <input type="text" name="q" class="form-control"
        placeholder="Buscar producto..." value="{{ request.GET.q }}">

    <button class="btn btn-primary" type="submit">Filtrar</button>
</form>

<div class="grilla-productos">
    {% for producto in productos %}
    <div class="tarjeta-producto">
        {% if producto.imagen %}
        <img src="{{ producto.imagen.url }}" alt="{{ producto.nombre }}" class="imagen-producto">
        {% else %}
        <div class="imagen-producto">Sin imagen</div>
        {% endif %}
        <div class="nombre-producto">{{ producto.nombre }}</div>
        <div class="descripcion-producto">{{ producto.descripcion|safe }}</div>
        <div class="precio-producto">${{ producto.precio }}</div>
        <div class="acciones-producto">
            <a href="{% url 'editar_producto' producto.id %}" class="btn-editar">Editar</a>
            <a href="{% url 'eliminar_producto' producto.id %}" class="btn-eliminar">Eliminar</a>
            <a href="{% url 'agregar_carrito' producto.id %}" class="btn-carrito">ðŸ›’ Agregar al Carrito</a>
        </div>
    </div>
    {% empty %}
    <p>No hay productos registrados.</p>
    {% endfor %}
</div>

{% endblock %}
